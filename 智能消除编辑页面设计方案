# 智能消除编辑页面设计方案
[image:78D5C88D-A5CB-44C9-B5DF-1B6C4B873CC1-24480-00000E66C690D120/截屏2022-03-30 下午1.45.27.png]
如上所示，可以通过简单的手指拖拽添加消除块（图上的矩形），可以添加多个，之后还可以修改消除块的位置和尺寸。

### 数据层设计 
#### 主Model 
持有素材资源对象，管理快照(Snapshot)数组以及指向当前快照的游标，对外提供撤销重 做以及更新数据的接口。 
#### Snapshot 
可以理解为一次操作现场，管理消除块数组以及记录当前选中了哪个消除块。
#### 消除块Model 
记录需要消除水印的位置尺寸等信息，包含x，y，width，height等属性，x和y是位置信 息，具体代表的是左上角还是中心点，需要看服务器接口设计。 
#### 消除视图展示模型 
消除视图数据结构，其中都是与位置尺寸相关信息，坐标基于UIKit。 业务模块拆分 
1. 主容器，功能入口
2. 画布，分为视频渲染和画布交互
3. 工具栏，包含播放器控制按钮、数据撤销重做删除按钮 4. 提示面板，提示操作信息
4. 导航栏，关闭页面和完成
5. 引导页，新手引导业务 
#### 主容器 
作为入口控制器，外部通过传入素材资源打开。
管理播放环境，持有播放器。
作为画布、工具栏、导航栏、引导页各业务控制器的容器控制器，管理子业务控制器的视图层级，调度临时态业务控制器，当数据变更时刷新管理的控器。
#### 画布 
主要有以下两个职责: 
1. 视频渲染 
2. 画布交互 
#### 渲染视频 
采用AVFoundation提供的视图组件渲染视频。 
画布交互 
拆分成两部分:
1. 手势的交互处理，计算出最终的位置尺寸信息并输出 
2. 消除块视图渲染，根据交互产生的最新数据刷新视图 
提示面板 
简单的视图展示，负责展示提示信息，目前是固定的文本提示。
#### 工具栏 
主要有以下职责: 
1. 播放器状态控制 2. 播放器进度控制 3. 撤销重做
2. 删除消除块 
对外提供事件回调，由主容器负责处理具体业务。
#### 导航栏 
负责关闭页面和展示页面标题。
对外提供事件回调，由主容器负责处理具体业务。
#### 引导页 
展示新手引导动态资源。 
